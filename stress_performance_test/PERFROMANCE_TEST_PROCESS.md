# 流程图编辑器性能测试文档

## 1.文档说明

本文档详细说明流程图编辑器性能测试的完整执行流程，包括测试准备、环境配置、执行步骤和数据记录方式，确保测试的可重复性和可审计性。

## 2.测试范围

本次性能测试涵盖六大场景，通过自动化脚本模拟真实用户操作：

1. 批量节点插入性能测试
2. 场景拖拽性能测试
3. 场景缩放性能测试
4. 场景框选性能测试
5. 撤销重做（Undo/Redo）性能测试
6. 文件保存与加载性能测试

## 3.测试环境

操作系统：Windows 10 或 Windows 11  
应用程序：Qt桌面程序（通过windeployqt打包）  
测试工具：Python 3 + PyAutoGUI自动化脚本  
Python版本：3.x  
依赖库：pyautogui、time  
测试数据规模：画布中约1000个节点

## 4.测试准备

### 4.1环境搭建

安装Python和PyAutoGUI，执行命令：pip install pyautogui

将测试脚本与被测程序放在同一目录下，目录结构示例：

/output/ 目录包含：
- run_test.py（批量插入测试脚本）
- run_drag_test.py（拖拽测试脚本）
- run_zoom_test.py（缩放测试脚本）
- run_selection_test.py（框选测试脚本）
- run_undo_redo_test.py（撤销重做测试脚本）
- run_save_load_test.py（保存加载测试脚本）
- FlowchartEditor.exe（被测应用程序）

### 4.2注意事项

确保Qt程序可正常启动并显示空白画布。测试期间严禁手动操作鼠标或键盘，所有操作由脚本自动完成。若需紧急停止脚本，可快速将鼠标移至屏幕任意角落触发PyAutoGUI的Fail-Safe机制。

## 5.测试执行流程

### 5.1测试一：批量插入性能

测试目的：测量连续插入1000个节点时程序的响应速度和UI事件处理性能。

执行步骤：

1. 手动打开流程图编辑器，保持画布为空
2. 执行命令：python run_test.py
3. 根据弹窗提示依次定位鼠标位置：左侧菜单的图形按钮、画布左上角、画布右下角
4. 脚本自动完成1000次节点插入
5. 完成后终端输出总耗时

数据记录：记录每轮测试的总耗时，示例：插入1000个节点耗时252.34秒

### 5.2测试二：场景拖拽性能

测试目的：评估在大量节点存在时，拖拽单个节点的流畅度和性能稳定性。

执行步骤：

1. 打开包含大量节点（不少于1000个）的画布
2. 将鼠标移动到任意一个节点上
3. 执行命令：python run_drag_test.py
4. 脚本自动执行20次往返拖拽操作

数据记录：记录20次拖拽的总耗时，示例：拖拽20次耗时19.22秒

### 5.3测试三：场景缩放性能

测试目的：评估画布视图对滚轮缩放事件的响应性能。

执行步骤：

1. 将鼠标移动到画布中心位置
2. 执行命令：python run_zoom_test.py
3. 脚本自动执行20次放大操作和20次缩小操作

实际观察：在实际测试中发现，缩放功能未能正常触发，滚轮操作仅导致画布上下移动，并未实现缩放效果。

数据记录：记录40次操作的总耗时，示例：缩放40次总耗时10.30秒

### 5.4测试四：场景框选性能

测试目的：模拟用户在大画布中框选大量节点时的程序表现。

执行步骤：

1. 在画布中确定框选区域的左上角和右下角位置
2. 执行命令：python run_selection_test.py
3. 脚本自动完成10次框选操作

实际观察：在实际测试中发现，虽然出现了框选的视觉动作，但并未成功选中任何图元。

数据记录：记录10次框选的总耗时，示例：框选10次耗时8.68秒

### 5.5测试五：撤销重做性能

测试目的：评估Undo和Redo功能在大量节点存在时的响应速度。

执行步骤：

1. 在画布中选中任意一个节点
2. 执行命令：python run_undo_redo_test.py
3. 脚本自动完成以下操作：移动节点50次生成50条可撤销记录、执行50次Undo操作、执行50次Redo操作

数据记录：分别记录Move、Undo、Redo的耗时，示例：Move 50次耗时17.56秒，Undo 50次耗时7.54秒，Redo 50次耗时7.75秒

### 5.6测试六：保存加载性能

测试目的：测量大文件保存和加载的实际耗时。

执行步骤：

1. 确保画布中包含大量节点（不少于1000个）
2. 执行命令：python run_save_load_test.py
3. 脚本自动完成保存操作（Ctrl+S并输入文件名）和加载操作（Ctrl+O并输入文件名）

数据记录：分别记录保存和加载的耗时，示例：保存文件耗时1.85秒，加载文件耗时1.86秒

## 6.数据汇总要求

每项测试需要执行至少五轮，记录以下数据：

- 最快时间
- 最慢时间  
- 平均时间

这些数据将用于生成最终性能评估报告。

## 7.测试规范与注意事项

测试期间严禁手动操作鼠标或键盘，避免脚本中断。若需终止脚本，可快速将鼠标移至屏幕角落触发PyAutoGUI的Fail-Safe机制。
若程序在高负载下出现卡死或无响应，需详细记录发生的时间点和界面状态。
脚本中的鼠标坐标参数和等待时间可根据不同设备的屏幕分辨率和性能进行适当调整。


## 8.实际记录

### 8.1 测试时编写了相应的五个自动化脚本，但在第一次压力测试run_test时出现问题：脚本自动打开程序后，终端后台显示，无法及时看到终端输出，可能会导致脚本执行失败。（如第一次测试时实际插入图元3个）同时由于后续的缩放框选测试都要基于大量图元的基础上进行测试，所以将后续脚本改为不再自动打开程序，而是通过alert提示测试者手动打开程序并确保存在大量图元后进行后续测试。

### 8.2 编写脚本时，测试者已经将程序运行方式（先点击图元再点击画布，而非拖拽式）告知LLM，据此编写脚本，因此插入测试时发现程序稳定性良好，但后续框选和缩放测试并不能实现相应功能，已经在测试结果文档中写明。

### 8.3 在发现压力测试性能良好后，为节省后续测试时间，将初始要求图元数量从1000改为50

### 8.4 每项实验均进行了五次，结果及分析已经在测试结果文档中说明

### 8.5 材料说明：性能测试所用脚本以及结果截图均放在./performance_test目录下。其中六个py文件是自动化脚本；test1-test5为压力测试的五次测试结果（成功插入1000个图元，但由于图元均为白色，所以并未显示明显边框，但实验结果无误）zoom_test.png为缩放测试结果，undo_redo&save_load.png为撤销恢复和保存加载测试结果，这两项测试先后进行，故结果用一张截图表示，selection_test.png为框选测试结果，drag_test为拖拽测试结果；result1-result5为对应终端运行结果截图
