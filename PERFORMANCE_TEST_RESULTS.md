# 流程图编辑器性能测试报告  
日期：2025-12-9

---

# 1. 测试目的

本次测试面向流程图编辑器在高负载情况下的整体性能表现，针对以下五个核心维度：

1. 批量插入节点性能  
2. 场景操作性能（拖拽 / 缩放 / 框选）  
3. 撤销/重做性能  
4. 保存性能  
5. 加载性能  

通过自动化脚本（PyAutoGUI）模拟真实用户操作，从而最大程度接近实际使用场景。

---

# 2. 测试环境

| 项目 | 配置 |
|------|------|
| 操作系统 | Windows 10/11 |
| 硬件配置 | x86-64 桌面平台 |
| 应用环境 | Qt 应用，windeployqt 打包为独立 exe |
| 自动化工具 | Python + PyAutoGUI |
| 数据规模 | 画布包含约 1000 个节点 |

---

# 3. 测试方法概述

每一类测试均使用专门的 Python 脚本执行，脚本逻辑完全模拟用户手势：

- 插入测试：菜单点击 → 插入点击 × 1000  
- 拖拽测试：左右往返拖拽 × 20  
- 缩放测试：滚轮放大 × 20 + 缩小 × 20  
- 框选测试：框选操作 × 10  
- Undo/Redo 测试：移动节点产生 50 条记录 → Undo 50 次 → Redo 50 次  
- 保存/加载测试：Ctrl+S 输入文件名 → Ctrl+O 输入文件名  

---

# 4. 批量插入节点性能

## 4.1 五次测量结果

| 轮次 | 插入 1000 节点耗时（秒） |
|------|--------------------------|
| 1 | 250.24 |
| 2 | 252.34 |
| 3 | 253.21 |
| 4 | 251.50 |
| 5 | 253.99 |

## 4.2 数据统计

| 指标 | 数值 |
|------|------|
| 最快耗时 | **250.24 s** |
| 最慢耗时 | **253.99 s** |
| 平均耗时 | **252.26 s** |
| 吞吐率 | **≈ 3.96 节点/秒** |

## 4.3 结论

插入性能稳定，但由于插入流程必须每次重新选择图形，导致平均耗时偏高，仍属于可接受范围（C 级性能）。

---

# 5. 场景拖拽性能

## 5.1 五次测量结果

| 轮次 | 拖拽 20 次耗时（秒） |
|------|----------------------|
| 1 | 18.90 |
| 2 | 19.47 |
| 3 | 19.45 |
| 4 | 18.62 |
| 5 | 19.66 |

## 5.2 数据统计

| 指标 | 数值 |
|------|------|
| 最快耗时 | **18.62 s** |
| 最慢耗时 | **19.66 s** |
| 平均耗时 | **19.22 s** |
| 平均拖拽频率 | **≈ 1.04 次/秒** |

## 5.3 结论

在 1000 节点负载下拖拽性能稳定，没有 UI 卡死现象，属于可用范围。

---

# 6. 场景缩放性能

## 6.1 五次测量结果

| 轮次 | 20 次放大 + 20 次缩小（秒） |
|------|-----------------------------|
| 1 | 10.16 |
| 2 | 10.19 |
| 3 | 10.17 |
| 4 | 10.18 |
| 5 | 10.79 |

## 6.2 数据统计

| 指标 | 数值 |
|------|------|
| 最快耗时 | **10.16 s** |
| 最慢耗时 | **10.79 s** |
| 平均耗时 | **10.30 s** |

## 6.3 **实际观察结果（关键）**

> **在实际测试中观察到：缩放测试并不能完成缩放功能，滚轮操作只导致画布上下移动，并未触发视图缩放行为。**

## 6.4 结论

当前软件版本可能尚未实现缩放或绑定滚轮缩放功能，因此该测试只能反映滚动性能，而无法评估真实缩放性能。

---

# 7. 场景框选性能

## 7.1 五次测量结果

| 轮次 | 框选 10 次耗时（秒） |
|------|-----------------------|
| 1 | 8.65 |
| 2 | 8.75 |
| 3 | 8.66 |
| 4 | 8.67 |
| 5 | 8.65 |

## 7.2 数据统计

| 指标 | 数值 |
|------|------|
| 最快耗时 | **8.65 s** |
| 最慢耗时 | **8.75 s** |
| 平均耗时 | **8.68 s** |

## 7.3 **实际观察结果（关键）**

> **在实际测试中观察到：框选测试并不能选中任何图元，仅执行了框选动作，但没有实际选中节点。**

## 7.4 结论

框选功能可能仍未实现或需要用户切换到特定模式，故本项仅反映框选动作性能，不反映真实多选能力。

---

# 8. Undo / Redo 性能

## 8.1 五次测量数据

| 轮次 | Move 50 次（秒） | Undo 50 次（秒） | Redo 50 次（秒） |
|------|------------------|------------------|------------------|
| 1 | 17.49 | 7.39 | 8.34 |
| 2 | 17.18 | 7.46 | 7.54 |
| 3 | 17.53 | 7.50 | 7.52 |
| 4 | 17.86 | 7.82 | 7.70 |
| 5 | 17.75 | 7.52 | 7.63 |

## 8.2 统计结果

| 指标 | Move（秒） | Undo（秒） | Redo（秒） |
|------|------------|------------|-------------|
| 最快耗时 | 17.18 | 7.39 | 7.52 |
| 最慢耗时 | 17.86 | 7.82 | 8.34 |
| 平均耗时 | **17.56** | **7.54** | **7.75** |

## 8.3 结论

- Undo/Redo 在高负载下表现稳定，无明显卡死或异常。  
- Undo 和 Redo 的平均耗时均 < 8 秒 / 50 次，属于可接受性能。  

---

# 9. 保存 / 加载（Save / Load）性能

## 9.1 五次测量数据

| 轮次 | 保存（秒） | 加载（秒） |
|------|-----------|------------|
| 1 | 1.85 | 1.88 |
| 2 | 1.75 | 1.73 |
| 3 | 1.88 | 1.85 |
| 4 | 1.93 | 1.90 |
| 5 | 1.83 | 1.92 |

## 9.2 数据统计

| 指标 | 保存 | 加载 |
|------|-------|--------|
| 最快耗时 | **1.75 s** | **1.73 s** |
| 最慢耗时 | 1.93 s | 1.92 s |
| 平均耗时 | **1.85 s** | **1.86 s** |

## 9.3 结论

- 保存和加载均在 **2 秒以内完成**，性能良好；  
- 在 1000 节点负载下依然能快速读写，说明序列化逻辑较为高效；  
- 未出现卡顿、UI 停滞或崩溃现象。

---

# 10. 总结（所有维度）

| 测试项 | 评价 | 说明 |
|--------|--------|--------|
| 批量插入性能 | 🟡 可接受 | 平均 252 秒/1000 节点，可优化 |
| 拖拽性能 | 🟢 良好 | 稳定，无卡死，约 1 次拖拽/秒 |
| 缩放性能 | 🔴 功能缺失 | 滚轮仅移动画布、无法缩放 |
| 框选性能 | 🔴 功能缺失 | 框选未能选中图元 |
| Undo/Redo 性能 | 🟢 良好 | Undo/Redo 50 次均 < 8 秒 |
| 保存性能 | 🟢 很好 | 平均 1.85 秒 |
| 加载性能 | 🟢 很好 | 平均 1.86 秒 |

终端测试结果如下：
![结果1](performance_test/result1.png)
![结果2](performance_test/result2.png)
![结果3](performance_test/result3.png)
![结果4](performance_test/result4.png)
![结果5](performance_test/result5.png)

---

# 11. 建议

重点建议如下：

### 11.1 功能补全（优先级最高）
- 完善 **缩放功能（滚轮缩放、Ctrl+滚轮缩放）**
- 完善 **框选功能（矩形选择区域内的节点检测）**

### 11.2 插入性能优化
- 支持“一次选择 → 多次插入”模式  
- 减少每次插入后的全局刷新次数  
- 批量操作时考虑关闭 Scene Index 或使用 NoIndex

### 11.3 交互性能优化
- 拖拽实时重绘可降低频率  
- Undo/Redo 可考虑合并相邻操作

---
